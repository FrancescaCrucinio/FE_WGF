push!(LOAD_PATH, "C:/Users/Francesca/Desktop/WGF/myModules")
# Julia packages
using StatsPlots;
using Distributions;
using Statistics;
using StatsBase;
using KernelEstimator;
using Random;
using JLD;
using Distances;
using LaTeXStrings;
using DataFrames;
using CSV;
using Query;
using RCall;
@rimport ks as rks
# custom packages
using wgf;

# set seed
Random.seed!(1234);
# # DATA
# df = DataFrame(CSV.File("epidemiology\\time_series_covid19_confirmed_global.csv"));
# # UK DATA
# q1 = @from i in df begin
#         @where Country/Region = United Kingdom & Province/State
#         @select {number_of_children=i.children, i.name}
#         @collect DataFrame
hSample = [0,0,0,0,0,0,0,0,0,2,2,2,8,8,9,9,9,13,14,14,15,16,17,18,18,18,19,19,20,22,23,23,28,30,34,37,44,56,61,94,134,189,245,294,373,428,482,629,887,1298,1787,2266,2630,3072,3684,4452,5451,6506,7760,8957,10333,12668,15039,17732,20816,24017,26839,29696,33969,38484,43398,48263,53178,57198,60792,66067,71517,76646,81498,85813,89390,92885,97068,101393,106458,111756,116721,121437,125289,130147,134907,140397,145540,150513,154261,157729,162431,167152,172587,177543,182270,185491,188465,191843,195527,199358,203125,206174,208324,210645,214228,217617,220915,223524,226041,228106,229932,232506,235547,238253,240795,242825,244332,245680,247287,248937,250739,252473,253977,255076,256145,257579,259046,260388,261622,262727,263518,264235,265321,266474,267656,268657,269710,270597,271404,272430,273507,274504,275524,276504,277170,277792,278684,279566,280340,281037,281675,282308,282703,283307,283710,283770,283774,284276,284900,285416,285768,286349,286979,287621,288133,288953,289603,290133,291373,291911,292552,293239,294066,294792,295372,295817,296377,297146,297914,298681,299426,300111,300658,301455,302301,303181,303942,304685,305623,306293,307184,308134,309005,309763,310825,311641,312789,313798,314927,316367,317379,318484,319197,320286,321098,322280,323313,324601,325642,326614,327798,328846,330368,331644,332752,334467,335873,337168,338676,340411,342351,344164,347152,350100,352560,355219,358138,361677,365174,368504,371125,374228,378219,381614,385936,390358,394257,398625,403551,409729,416363,423236,429277,434969,439013,446156,453264,460178,467146,480017,502978,515571];

alpha = 4.9^2/3.3^2;
beta = 4.9/3.3.^2;
sigma = sqrt(2log(5.5/5.2));
mu = log(5.2);

Nparticles = 500;
M = 500;
dt = 1e-3;
Niter = 100;
x0 = randn(Nparticles);
alpha = 0.01;
x = wgf_C19_tamed(Nparticles, dt, Niter, alpha, x0, hSample, M, 0.5);
